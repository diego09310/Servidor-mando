#! /bin/sh
# Script que realiza el reconocimiento de voz mediante el servicio de Google
# Parámetros: ruta al fichero (sin .wav) idioma-PAÍS del fichero en código ISO y frecuencia de muestreo 
# Devuelve un fichero con la transcripción

audio=$1
language=$2 #es-ES
rate=$3

# Conversión a flac, formato con el que trabaja Google
sox $audio.wav -r $rate $audio.flac
echo HOLA
#Petición POST y "limpieza" del fichero
curl --data-binary @${audio}.flac -s --header 'Content-type: audio/x-flac; rate='$rate 'https://www.google.com/speech-api/v1/recognize?client=chromium&pfilter=0&lang='$language'&maxresults=1' | cut -d"," -f3 | sed 's/^.*utterance\":\"\(.*\)\"$/\1/g' 1>transcription.txt
